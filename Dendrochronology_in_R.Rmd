---
title: "Dendrochronology in R"
author: "Jen Baron, j.baron@alumni.ubc.ca, UBC Tree Ring Lab"
date: 'May 8, 2020'
output:
  html_document:
    keep_md: yes
    number_sections: yes
    theme: sandstone
    toc: yes
    toc_float: yes
---

# Packages

```{r setup}
library(dplR) # dendrochronology
library(tidyr)
library(ggplot2)
```

# Load Data

```{r}
pinery.rwl <- read.rwl("data/pinery.rwl")
#master_all.rwl <- read.rwl("data/master_all.rwl")
```

```{r}
rwl.report(pinery.rwl)
```

# Basic Summary Statistics

```{r}
rwl.stats(pinery.rwl)
```

```{r}
seg.plot(pinery.rwl)
```

## Truncate Based on Date / Sample Depth

Truncate to 1898 (sample depth = 8)

```{r}
pinery.rwl.trunc <- pinery.rwl[46:166,]
```






# Crossdating


```{r}
pinery.corr <- corr.rwl.seg(pinery.rwl.trunc, seg.length = 50, 1918)
```

```{r}
#identify flags
flags <- as.data.frame(pinery.corr$flags) 
flags

#average series correlation
avg.seg.rho <- as.data.frame(pinery.corr$avg.seg.rho)
avg.seg.rho %>% round(2)

#correlation by series
overall <- pinery.corr$overall
overall %>% round(2)

#correlation by segment and series
rho <- as.data.frame(pinery.corr$spearman.rho)
rho %>% round(2)
```




